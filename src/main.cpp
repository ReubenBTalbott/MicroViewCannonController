#include <Arduino.h>
#include <MicroView.h>
int booting = 0;
int bootscreen = 0;
int code = 0;

int confirmButton = 0;
int confirmState = 0;

uint8_t nuke[] = {
    0x00, 0xf8, 0xf8, 0x38, 0xe0, 0x80, 0x00, 0xf8, 0xf8, 0x00, 0x00, 0xe0, 0xe0, 0x00, 0x00, 0x00,
    0xe0, 0xe0, 0x00, 0x00, 0xfc, 0xfc, 0x80, 0xc0, 0x60, 0x20, 0x80, 0xc0, 0x60, 0x60, 0x60, 0xc0,
    0x80, 0x00, 0x00, 0x00, 0xc0, 0xf0, 0x18, 0x08, 0x08, 0x08, 0x08, 0x38, 0xe0, 0x00, 0x00, 0x70,
    0xc8, 0x88, 0x88, 0x08, 0x00, 0x00, 0xe0, 0x10, 0xc8, 0x68, 0x28, 0x28, 0x08, 0x10, 0xe0, 0x00,
    0x00, 0x1f, 0x1f, 0x00, 0x00, 0x03, 0x0e, 0x1f, 0x1f, 0x00, 0x00, 0x0f, 0x1f, 0x18, 0x10, 0x18,
    0x1f, 0x1f, 0x00, 0x00, 0x1f, 0x1f, 0x07, 0x0c, 0x18, 0x90, 0x8f, 0x9f, 0x92, 0x92, 0x92, 0x9b,
    0x99, 0x80, 0x80, 0x80, 0x03, 0x0f, 0x18, 0x10, 0x10, 0x10, 0x18, 0x0c, 0x07, 0x00, 0x00, 0x10,
    0x10, 0x10, 0x11, 0x1f, 0x0e, 0x00, 0x07, 0x08, 0x13, 0x16, 0x14, 0x14, 0x10, 0x08, 0x07, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0xc0, 0x20, 0x90, 0xe8, 0xf4, 0xf2, 0xfa, 0xf1, 0xe1, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x80, 0xe1, 0xf1, 0xfa, 0xf2, 0xf4, 0xe8, 0x90, 0x20, 0xc0, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfc, 0x03,
    0x7c, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7e, 0x78, 0x30, 0x80, 0xc0, 0x80,
    0x30, 0x78, 0x7e, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7f, 0x7c, 0x03, 0xfc, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 0x60,
    0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xe0, 0xf8, 0xfc, 0xfd, 0xfc,
    0xf8, 0xe0, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x60, 0x1f, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x20, 0x40, 0x5c, 0x9f, 0xbf, 0xbf, 0xbf, 0xbf, 0xbf, 0xbf,
    0xbf, 0xbf, 0xbf, 0x9f, 0x5c, 0x40, 0x20, 0x20, 0x10, 0x08, 0x04, 0x02, 0x01, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

uint8_t switches[] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,
    0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,
    0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0,
    0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0xE0, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x01, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0x01,
    0x00, 0x00, 0x01, 0xFF, 0xFF, 0x01, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0x01, 0x00, 0x00, 0x01, 0xFF,
    0xFF, 0x01, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0x01, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0x01, 0x00, 0x00,
    0x01, 0xFE, 0xFF, 0x01, 0x00, 0x00, 0x01, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00,
    0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF,
    0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00,
    0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00,
    0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF,
    0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00,
    0x00, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0x3F, 0x3F, 0x3F, 0x3E, 0x3C, 0x3C, 0x3E, 0x3F, 0x3F, 0x3E,
    0x3C, 0x3C, 0x3E, 0x3F, 0x3F, 0x3E, 0x3C, 0x3C, 0x3E, 0x3F, 0x3F, 0x3E, 0x3C, 0x3C, 0x3E, 0x3D,
    0x3F, 0x3E, 0x3C, 0x3C, 0x3E, 0x3F, 0x3F, 0x3E, 0x3C, 0x3C, 0x3E, 0x3F, 0x3F, 0x3E, 0x3C, 0x3C,
    0x3E, 0x3F, 0x3F, 0x3E, 0x3C, 0x3C, 0x3E, 0x3F, 0x3F, 0x3F, 0x3F, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

void setup()
{
  // put your setup code here, to run once:
  pinMode(confirmButton, INPUT_PULLUP);

  if (booting == 0)
  {
    uView.begin();
    uView.clear(PAGE);
    uView.setFontType(1);

    for (int x = 0; x < 3; x++)
    {
      uView.clear(PAGE);
      uView.setCursor(0, 0);
      uView.print("Booting");
      uView.display();
      delay(500);

      uView.clear(PAGE);
      uView.setCursor(0, 0);
      uView.print("Booting.");
      uView.display();
      delay(500);

      uView.clear(PAGE);
      uView.setCursor(0, 0);
      uView.print("Booting..");
      uView.display();
      delay(500);

      uView.clear(PAGE);
      uView.setCursor(0, 0);
      uView.print("Booting...");
      uView.display();
      delay(500);
    }
    uView.clear(PAGE);
    uView.setCursor(0, 0);
    uView.drawBitmap(nuke);
    //uView.setCursor(0, 0);
    // uView.print("Nuke OS");
    uView.display();
    delay(5000);
  }
}

void loop()
{
  // put your main code here, to run repeatedly:
  while (bootscreen == 0)
  {
    confirmState = digitalRead(confirmButton);

    uView.clear(PAGE);
    uView.setCursor(0, 0);
    uView.print("Please");
    uView.setCursor(0, 14);
    uView.print("Enter");
    uView.setCursor(0, 28);
    uView.print("Code");
    //uView.setCursor(0, 40);
    //uView.print("Code");
    uView.display();
    if (confirmState == LOW)
    {
      bootscreen = 1;
    }
  }
  uView.clear(PAGE);
  uView.setCursor(0, 0);
  uView.drawBitmap(switches);
  uView.display();
}